# 新功能使用指南

## 新增功能概述

本次更新为 PDF 智能分析助手添加了两个重要功能：

1. **文件删除功能** - 可以删除不需要的 PDF 文件及其所有相关文件
2. **任务取消功能** - 可以在处理过程中随时终止任务

## 功能详细说明

### 1. 文件删除功能

#### 功能描述

- 可以删除任意已处理的 PDF 文件
- 自动删除该文件的所有相关文件，包括：
  - 原始 PDF 文件
  - 转换后的图片文件
  - 分析结果文件
  - 其他相关目录

#### 使用方法

1. 在文件管理界面中，找到要删除的文件
2. 点击文件右侧的红色"删除"按钮
3. 在确认对话框中确认删除操作
4. 系统将自动删除该文件的所有相关文件

#### 安全特性

- 删除前会显示确认对话框，防止误删
- 正在处理中的文件无法删除
- 删除操作不可撤销，请谨慎操作

### 2. 任务取消功能

#### 功能描述

- 可以在 PDF 处理过程中随时取消任务
- 已处理的部分会保留，未处理的部分会停止
- 取消后可以重新开始处理

#### 使用方法

1. 上传 PDF 文件并开始处理后
2. 在进度显示区域会显示红色的"取消任务"按钮
3. 点击取消按钮
4. 在确认对话框中确认取消操作
5. 任务将立即停止，已处理的部分会保留

#### 技术特性

- 取消操作是异步的，会立即响应
- 已处理的页面分析结果会保留
- 可以重新上传相同文件继续处理

## 技术实现

### 后端实现

- 添加了 `DELETE /api/files/<pdf_name>` 接口用于删除文件
- 完善了 `POST /api/cancel/<file_id>` 接口用于取消任务
- 在 PDF 处理循环中添加了取消检查机制
- 使用 `shutil.rmtree()` 安全删除目录和文件

### 前端实现

- 在文件列表中添加了删除按钮
- 优化了取消按钮的显示逻辑
- 添加了确认对话框防止误操作
- 改进了用户交互体验

## 使用注意事项

1. **删除功能**

   - 删除操作不可撤销，请确认后再操作
   - 正在处理中的文件无法删除
   - 删除会清理所有相关文件，包括图片和分析结果

2. **取消功能**

   - 取消后已处理的部分会保留
   - 可以重新上传文件继续处理
   - 取消操作会立即生效

3. **性能考虑**
   - 删除大文件可能需要一些时间
   - 取消任务后建议等待几秒再重新开始

## 故障排除

### 删除功能问题

- 如果删除失败，检查文件是否正在处理中
- 确认有足够的文件系统权限
- 查看后端日志获取详细错误信息

### 取消功能问题

- 如果取消按钮不显示，刷新页面重试
- 取消操作可能需要几秒钟才能生效
- 如果任务仍在继续，等待几秒后再次尝试

## 更新日志

- ✅ 添加文件删除 API 接口
- ✅ 添加前端删除按钮和确认对话框
- ✅ 完善任务取消机制
- ✅ 优化取消按钮显示逻辑
- ✅ 添加安全检查和错误处理
- ✅ 改进用户交互体验
